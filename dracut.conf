# dracut.conf - Dracut configuration for reproducible builds

# Explicitly set the modules to include, overriding dracut's defaults.
# This avoids errors from missing tools in the build environment.
dracutmodules+=" base shutdown fs-lib virtio crypt network 99paypal-auth-vm "

# Omit modules we know we don't need (less critical now, but good practice)
omit_dracutmodules+=" dash plymouth "

# Compression
compress="xz"
compresslevel="9"

# Reproducibility settings
export SOURCE_DATE_EPOCH="1640995200"  # Fixed timestamp
export TZ="UTC"

# Host-only mode disabled for reproducibility
hostonly="no"
hostonly_cmdline="no"

# Install kernel modules
kernel_cmdline=""
add_drivers+=" virtio_pci virtio_blk dm_crypt "

# Firmware
firmware_dirs="/lib/firmware"

# No local system configuration
no_host_only_commandline="yes"

# Do not require kernel modules
no_kernel="yes"
